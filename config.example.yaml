# VPN Rotator Configuration Example

# Service configuration
service:
  shutdown_timeout: 30s

# Logging configuration
log:
  level: info      # debug, info, warn, error
  format: json     # json, text

# API server configuration
api:
  listen_addr: ":8080"

# Database configuration
db:
  path: "./data/rotator.db"
  max_open_conns: 25
  max_idle_conns: 5
  conn_max_lifetime: 300  # seconds

# Scheduler configuration
scheduler:
  rotation_interval: 24h  # How often to rotate nodes
  cleanup_interval: 1h    # How often to check for cleanup
  cleanup_age: 2h         # Age before destroying nodes

# Activity monitor configuration
monitor:
  interval: 30s           # How often to check node activity
  ssh_user: root          # SSH user for connecting to nodes

# Hetzner provider configuration
hetzner:
  api_token: ""                                    # Set via VPN_ROTATOR_HETZNER_API_TOKEN env var
  server_types: [ "cx11", "cx21" ]                  # Server types to use
  image: "ubuntu-22.04"                           # OS image
  locations: [ "nbg1", "fsn1" ]                     # Datacenter locations
  ssh_key: ""                                     # SSH public key content
  ssh_private_key_path: "/path/to/private/key"    # Path to SSH private key

# Node service configuration
node_service:
  max_peers_per_node: 50                          # Maximum peers per node
  capacity_threshold: 80.0                        # Capacity threshold percentage
  health_check_timeout: 30s                       # Health check timeout
  provisioning_timeout: 10m                       # Node provisioning timeout
  destruction_timeout: 5m                         # Node destruction timeout
  optimal_node_selection: "least_loaded"          # Node selection strategy: least_loaded, round_robin, random

# Circuit breaker configuration
circuit_breaker:
  failure_threshold: 5                            # Number of failures before opening
  reset_timeout: 60s                              # Time before attempting reset
  max_attempts: 3                                 # Maximum retry attempts

# Peer service optimization configuration
peer:
  # Cache settings for performance optimization
  enable_ip_cache: true                           # Enable IP validation caching
  cache_cleanup_period: 5m                       # How often to clean up cache
  max_cache_size: 10000                          # Maximum number of cached IPs

  # Batch operation settings for high throughput
  max_batch_size: 100                            # Maximum peers per batch operation
  batch_timeout: 30s                             # Timeout for batch operations
  enable_batch_creation: true                    # Enable batch peer creation

  # Object pool settings for memory optimization
  enable_object_pool: true                       # Enable peer object pooling
  max_pool_size: 1000                           # Maximum objects in pool

  # Validation and monitoring settings
  strict_validation: true                        # Enable strict validation
  enable_metrics: false                          # Enable performance metrics collection